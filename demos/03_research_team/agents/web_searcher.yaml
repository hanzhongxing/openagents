# Web Searcher Agent - Information Gatherer
# Searches the web for information when delegated tasks from the router

type: "openagents.agents.collaborator_agent.CollaboratorAgent"
agent_id: "web-searcher"

config:
  model_name: "gpt-4o-mini"

  # CRITICAL: Limit tool calls to prevent duplicates
  max_iterations: 5

  # Custom tools for web search
  tools:
    - name: "search_web"
      description: "Search the web for information. Uses Brave Search if BRAVE_API_KEY is set, otherwise uses DuckDuckGo."
      implementation: "tools.web_search.search_web"
      input_schema:
        type: object
        properties:
          query:
            type: string
            description: "The search query"
          count:
            type: integer
            description: "Number of results to return (default 5)"
        required:
          - query

    - name: "fetch_webpage"
      description: "Fetch and extract text content from a webpage URL."
      implementation: "tools.web_search.fetch_webpage"
      input_schema:
        type: object
        properties:
          url:
            type: string
            description: "The URL to fetch"
          max_length:
            type: integer
            description: "Maximum content length (default 8000)"
        required:
          - url

    - name: "search_hackernews"
      description: "Search Hacker News for discussions and articles on a topic."
      implementation: "tools.web_search.search_hackernews"
      input_schema:
        type: object
        properties:
          query:
            type: string
            description: "The search query"
          count:
            type: integer
            description: "Number of results (default 5)"
        required:
          - query

  instruction: |
    You are the WEB SEARCHER. When you get a task, search and report results.

    RULE: Call each search function ONLY ONCE. Then send results and finish.

  # Only react to events with explicit triggers
  react_to_all_messages: false

  triggers:
    - event: "task.delegate"
      instruction: |
        Do these steps IN ORDER:
        1. search_web(query=query from payload, count=3)
        2. search_hackernews(query=short keywords, count=3)
        3. send_event(event_name="task.complete", destination_id="router", payload={"task_id": "s1", "results": "[combined search results]", "status": "success"})
        4. finish()

        Call search_web ONCE. Call search_hackernews ONCE. Then report and finish.

mods:
  - name: "openagents.mods.workspace.project"
    enabled: true
  - name: "openagents.mods.workspace.default"
    enabled: true

connection:
  host: "localhost"
  port: 8700
  transport: "grpc"
  # Password hash for "researcher" - matches researchers group in network.yaml
  password_hash: "3588bb7219b1faa3d01f132a0c60a394258ccc3049d8e4a243b737e62524d147"
