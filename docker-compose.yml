version: '3.8'

services:
  openagents:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: openagents-network-studio
    ports:
      - "8700:8700"  # HTTP transport (also serves Studio at /studio and MCP at /mcp)
      - "8600:8600"  # gRPC transport
    environment:
      - PYTHONUNBUFFERED=1
      - NODE_ENV=production
      # Optional: Add your API keys here
      # - OPENAI_API_KEY=${OPENAI_API_KEY}
      # - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
    volumes:
      # Persist data between restarts
      - openagents-data:/app/data
      # Optional: Mount custom network folder
      # - ./my-network:/network:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8700/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    networks:
      - openagents-network

volumes:
  openagents-data:
    driver: local

networks:
  openagents-network:
    driver: bridge
